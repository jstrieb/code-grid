<!--
  Created by Jacob Strieb.
  Fall 2024 - Fall 2025
-->
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Spreadsheet</title>

    <!-- TODO: other meta tags -->

    <!--
      Prefer rectangular opengraph photo, so use it first and last. Applications
      may pick the square one if they prefer that resolution, but shouldn't pick
      it based on ordering.
    -->
    <meta
      property="og:image"
      content="https://jstrieb.github.io/code-grid/opengraph.png"
    />
    <meta property="og:image:alt" content="Code Grid" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta
      property="og:image"
      content="https://jstrieb.github.io/code-grid/favicon-512.png"
    />
    <meta property="og:image:alt" content="Code Grid" />
    <meta property="og:image:width" content="512" />
    <meta property="og:image:height" content="512" />
    <meta
      property="og:image"
      content="https://jstrieb.github.io/code-grid/opengraph.png"
    />
    <meta property="og:image:alt" content="Code Grid" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />

    <!-- 
      Favicons seem to be picked from last to first, so put the best ones last.
    -->
    <link
      rel="apple-touch-icon"
      type="image/png"
      sizes="512x512"
      href="/favicon-512.png"
    />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png" />
    <link rel="icon" type="image/png" sizes="128x128" href="/favicon-128.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="/favicon-512.png" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="manifest" href="/manifest.json" />
  </head>
  <body>
    <style>
      * {
        margin: 0;
      }

      body {
        padding: 0.5em;
        /* Fall back on vh units if svh doesn't work (i.e., not on mobile). */
        height: 100vh;
        min-height: 100vh;
        max-height: 100vh;
        /* Use svh instead of dvh so it doesn't reflow when dynamic parts move. */
        height: 100svh;
        min-height: 100svh;
        max-height: 100svh;
      }

      div {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        gap: 1em;
        height: 100%;
        font-family: sans-serif;
      }
    </style>
    <div>
      <img
        width="64"
        height="64"
        src="data:image/svg+xml,%3Csvg version='1.1' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg'%3E%3Cstyle%3E /* @media (prefers-color-scheme: dark) %7B g %7B filter: invert(); %7D %7D */ :root %7B --offset: calc(32px - 28.734px); --offset2: calc(27.766px - 32px); %7D @keyframes orbit %7B 0%25 %7B transform: translate(0); %7D 25%25 %7B transform: translate(var(--offset), 0); %7D 50%25 %7B transform: translate(var(--offset), var(--offset)); %7D 75%25 %7B transform: translate(0, var(--offset)); %7D %7D @keyframes orbit2 %7B 0%25 %7B transform: translate(0); %7D 25%25 %7B transform: translate(var(--offset2), 0); %7D 50%25 %7B transform: translate(var(--offset2), var(--offset2)); %7D 75%25 %7B transform: translate(0, var(--offset2)); %7D %7D g:last-of-type %3E * %7B animation: orbit 5s linear infinite; animation-delay: 1s; %7D g:first-of-type %3E * %7B animation: orbit2 5s linear infinite; animation-delay: 1s; %7D %3C/style%3E%3Cg%3E%3Crect x='4.2341' y='4.2341' width='27.766' height='27.766' fill='%23000' stroke-width='.9794'/%3E%3Crect x='4.569' y='4.569' width='27.096' height='27.096' stroke='%23000' stroke-width='1.5'/%3E%3C/g%3E%3Cg stroke-width='.9794'%3E%3Crect x='0' y='0' width='28.734' height='28.734' fill='%23000'/%3E%3Crect x='.819' y='.819' width='27.096' height='27.096' fill='%23fff' stroke='%23000'/%3E%3Cpath d='m21.495 12.928h-14.256v-2.9896h14.256zm0 5.8677h-14.256v-2.9896h14.256z'/%3E%3C/g%3E%3C/svg%3E%0A"
      />
      <p>Loading...</p>
    </div>
  </body>
  <script type="module">
    import { mount } from "svelte";

    import "./src/global.css";
    import App from "./src/App.svelte";
    import { decompressText } from "./src/lib/compress.js";

    // Decompression must be async, so we wait until it's complete to initialize
    // and mount the main component. The globals object is created when the App
    // is initialized, and relies on the decompressed data.
    decompressText(window.location.hash.slice(1))
      .catch((e) => {
        console.error(e);
        return undefined;
      })
      .then((urlData) => {
        document.body.innerHTML = "";
        const app = mount(App, {
          target: document.body,
          props: { urlData },
        });
      });
  </script>
</html>
